STATUS: DONE

# PR 002: The Memory (SQLite)

**Objective:** Set up the persistent storage layer to track users, their interactions, and the history of seen papers.

**Context:**
We need a local database to maintain state. We must know which papers a user has already voted on to avoid duplicates, and we need to log their preferences to build the training set for the LLM later.

**Requirements:**

1.  **Database Setup (`database.py`):**
    *   Use `sqlite3`.
    *   Define a global constant `DB_PATH = 'cortex.db'`.
    *   Create an `init_db()` function to run the schema creation.

2.  **Schema Definition:**
    *   **Table `users`**:
        *   `telegram_id` (Integer, Primary Key).
        *   `joined_at` (Timestamp).
        *   `status` (Text, default 'calibration'). options: 'calibration', 'active'.
    *   **Table `papers`**:
        *   `id` (Integer, Primary Key, Auto Increment).
        *   `arxiv_id` (Text, Unique).
        *   `title` (Text).
        *   `sub_category` (Text).
        *   `abstract` (Text).
        *   `published` (Timestamp).
    *   **Table `interactions`**:
        *   `id` (Integer, Primary Key, Auto Increment).
        *   `user_id` (Integer, Foreign Key to users.telegram_id).
        *   `paper_id` (Integer, Foreign Key to papers.id).
        *   `action` (Text). options: 'interested', 'not_interested'.
        *   `timestamp` (Timestamp).

3.  **Data Access Layer (Helper Functions in `database.py`):**
    *   `add_user(telegram_id)`: Idempotent (ignore if exists).
    *   `store_paper(paper_data)`: Insert paper if not exists. Returns paper_id.
    *   `log_interaction(user_id, paper_id, action)`: Records the vote.
    *   `get_unseen_papers(user_id, limit=10)`: Advanced query. Select papers that *do not* have a corresponding entry in `interactions` for this user.

**Acceptance Criteria:**
*   Running `init_db()` creates the file `cortex.db`.
*   Tables have correct columns.
*   Helper functions successfully insert and retrieve data. (Add a small test script/block to verify).
