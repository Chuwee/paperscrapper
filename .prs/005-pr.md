STATUS: DOING

# PR 005: The Calibration Loop

**Objective:** Wire up the logic to handle the two user states: Calibration (Broad/Random) vs Active (Targeted).

**Context:**
A new user has no history, so the LLM has nothing to work with. We need a "Cold Start" mechanism.

**Requirements:**

1.  **Logic Update (`manager.py` or `brain.py` extensions):**
    *   Create a function `get_matches_for_user(user_id) -> list[papers]`.
    *   **Logic Flow:**
        1.   Fetch user status from DB.
        2.   **If 'calibration':**
            *   Fetch the latest 50 papers from `harvester`.
            *   Select 10 semi-randomly, ensuring category diversity (e.g., 2 Math, 2 CS, 2 Physics).
            *   Filter out papers already seen (check `interactions` table).
            *   Return these 10.
            *   *Check:* If user has > 20 interactions, `db.update_user_status(user_id, 'active')`.
        3.   **If 'active':**
            *   Fetch latest papers.
            *   Run `brain.evaluate_paper` on each.
            *   Return only those that return `True`.

2.  **State Management:**
    *   Ensure the transition from Calibration -> Active happens automatically based on the interaction count.

**Acceptance Criteria:**
*   New users receive Diverse papers.
*   Users with sufficient history receive Recommended papers.
*   System handles the transition state correctly.
